LOAD EMPLOYEE 
LOAD PROJECT
LOAD WORKS_ON

CROSS_EE <- CROSS EMPLOYEE EMPLOYEE
RELATION_EE <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM CROSS_EE
RELATION_EE1 <- SELECT EMPLOYEE1_Dno != EMPLOYEE2_Dno FROM RELATION_EE
RENAME EMPLOYEE1_Ssn TO Ssn FROM RELATION_EE1
RENAME EMPLOYEE1_Dno TO Dno FROM RELATION_EE1
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM RELATION_EE1
RENAME EMPLOYEE2_Dno TO Super_dno FROM RELATION_EE1
Q1 <- PROJECT Ssn, Dno, Super_ssn, Super_dno FROM RELATION_EE1

CROSS_WORPRO <- CROSS WORKS_ON PROJECT
RELATION_WORPRO <- SELECT Pno == Pnumber FROM CROSS_WORPRO
CROSS_EWP <- CROSS EMPLOYEE RELATION_WORPRO
RELATION_EWP <- SELECT Ssn == Essn FROM CROSS_EWP
RELATION_EWP1 <- SELECT Dno == Dnum FROM RELATION_EWP
RENAME Dnum TO P_dno FROM RELATION_EWP1
Q2 <- PROJECT Ssn, Dno, Pno, P_dno FROM RELATION_EWP1

CROSS_WP <- CROSS WORKS_ON PROJECT
RELATION_WP <- SELECT Pno == Pnumber FROM CROSS_WP
CROSS_EWP3 <- CROSS EMPLOYEE RELATION_WP
REL_EWP <- SELECT Ssn == Essn FROM CROSS_EWP3
REL_EWP1 <- SELECT Dno != Dnum FROM REL_EWP
RENAME Dnum TO P_dno FROM REL_EWP1
Q3 <- PROJECT Ssn, Dno, Pno, P_dno FROM REL_EWP1

CROSS_EMPEMP <- CROSS EMPLOYEE EMPLOYEE
REL_EMPEMP1 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM CROSS_EMPEMP
REL_Q4 <- SELECT EMPLOYEE1_Bdate < EMPLOYEE2_Bdate FROM REL_EMPEMP1
RENAME EMPLOYEE1_Ssn TO Essn FROM REL_Q4
RENAME EMPLOYEE1_Bdate TO E_bdate FROM REL_Q4
RENAME EMPLOYEE2_Bdate TO Super_bdate FROM REL_Q4
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM REL_Q4
Q4 <- PROJECT Super_ssn, Super_bdate, Essn, E_bdate FROM REL_Q4

CROSS_EMEM <- CROSS EMPLOYEE EMPLOYEE
CROSS_EMEM1 <- SELECT EMPLOYEE1_Dno == EMPLOYEE2_Dno FROM CROSS_EMEM
REL_Q5 <- SELECT EMPLOYEE1_Sex != EMPLOYEE2_Sex FROM CROSS_EMEM1
RENAME EMPLOYEE1_Dno TO Dno FROM REL_Q5
Q5 <- PROJECT Dno FROM REL_Q5

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
QUIT


